---
title: "04_Descriptive_Stats"
author: "Abraham Ybarra"
date: '2023-02-06'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries

```{r cars}
library(tidyverse)
library(here)
```

## Read in data

```{r}
######## Read in F21 (Ashley) Data ############
studentSummary <- read.csv(paste0(here(),"/clean_data/F21_Ashley/studentSummary.csv"), header = TRUE)
late <- read.csv(paste0(here(),"/clean_data/F21_Ashley/lateAssignments.csv"), header = TRUE)
missing <- read.csv(paste0(here(),"/clean_data/F21_Ashley/missingAssignments.csv"), header = TRUE)
grades <- read.csv(paste0(here(),"/clean_data/F21_Ashley/gradebook.csv"), header = TRUE)
```

## Histogram plotting function

```{r}
######## Histogram plotting function ############
plot_histogram <- function(xvar, binwidth) {
  p <- ggplot(studentSummary) +
    
    # aesthetics
    geom_histogram(aes_string(x = xvar), binwidth = binwidth, color = "blue", fill = "blue", alpha = .5) +
      
    # title and label axes
    ggtitle(paste("Distribution of", xvar)) +
    xlab(xvar) + 
    
    # Font size
   theme(text = element_text(size = 12),
         axis.text.x = element_text(size = 12, margin = margin(5,0,20,0)),
         axis.text.y = element_text(size = 12, margin = margin(0,5,0,20)),
         plot.title = element_text(size = 16, margin = margin(0,0,20,0), hjust = 0.5)) +
    theme_classic()
    
  ggsave(paste0(here(),"/Plots/Descriptive Stats/Distribution of ",xvar,".jpeg"))
}
```

## Plot histograms 
```{r}
######## Histograms for distribution of each variable ############
plot_histogram(xvar = "Overall.course.grade", binwidth = 5)
plot_histogram(xvar = "Final.Exam.Score", binwidth = 5)
plot_histogram(xvar = "pctOnTime", binwidth = .05)
plot_histogram(xvar = "Page.Views", binwidth = 100)
plot_histogram(xvar = "Participations", binwidth = 10)
```




